<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitly - Virtual Try-On</title>
    <link rel="stylesheet" href="sidebar.css">
</head>

<body>
    <div id="app">
        <!-- Header - Instagram Style -->
        <header class="header">
            <div class="logo">
                <span class="logo-text">Fitly</span>
            </div>
            <div class="header-actions">
                <button id="language-btn" class="lang-btn" title="Ng√¥n ng·ªØ">
                    üåê
                </button>
                <button id="gems-display" class="gems-badge" title="Mua th√™m gems">
                    <span class="gem-icon">üíé</span>
                    <span id="gems-count" class="gem-count">0</span>
                </button>
                <div class="profile-wrapper">
                    <button id="profile-btn" class="profile-btn" title="T√†i kho·∫£n">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="8" r="4" />
                            <path d="M20 21a8 8 0 00-16 0" />
                        </svg>
                    </button>
                    <!-- Profile Dropdown Menu -->
                    <div id="profile-menu" class="profile-dropdown hidden">
                        <div class="profile-menu-header">
                            <div id="menu-avatar" class="menu-avatar-circle"></div>
                            <div class="menu-user-info">
                                <span id="menu-username" class="menu-username">User</span>
                                <span id="menu-email" class="menu-email">email@example.com</span>
                            </div>
                        </div>
                        <div class="profile-menu-divider"></div>
                        <div class="profile-menu-items">
                            <button class="profile-menu-item" id="menu-webapp">
                                <span class="menu-icon">üåê</span>
                                <span class="menu-item-text">M·ªü Fitly Web</span>
                            </button>
                            <button class="profile-menu-item" id="menu-wardrobe">
                                <span class="menu-icon">üì¶</span>
                                <span class="menu-item-text">T·ªß ƒë·ªì c·ªßa t√¥i</span>
                            </button>
                            <button class="profile-menu-item" id="menu-cache-settings">
                                <span class="menu-icon">üíæ</span>
                                <span class="menu-item-text">Qu·∫£n l√Ω b·ªô nh·ªõ</span>
                                <span id="menu-cache-size" class="menu-badge">0 MB</span>
                            </button>
                            <button class="profile-menu-item" id="menu-help">
                                <span class="menu-icon">‚ùì</span>
                                <span class="menu-item-text">Tr·ª£ gi√∫p</span>
                            </button>
                            <div class="profile-menu-divider"></div>
                            <button class="profile-menu-item danger" id="menu-logout">
                                <span class="menu-icon">üö™</span>
                                <span class="menu-item-text">ƒêƒÉng xu·∫•t</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Gems Purchase Panel (hidden by default) -->
        <section id="gems-panel" class="gems-panel hidden">
            <div class="gems-panel-header">
                <h3>üíé Mua Gems</h3>
                <button id="close-gems-panel" class="close-btn">√ó</button>
            </div>
            <p class="gems-panel-subtitle">S·ªë d∆∞: <span id="gems-panel-balance">0</span> gems</p>

            <div class="gem-packages">
                <button class="gem-package" data-package="starter">
                    <div class="package-icon">‚ö°</div>
                    <div class="package-info">
                        <span class="package-name">Starter</span>
                        <span class="package-gems">50 gems</span>
                    </div>
                    <span class="package-price">49.000‚Ç´</span>
                </button>

                <button class="gem-package popular" data-package="pro">
                    <span class="package-badge">Ph·ªï bi·∫øn</span>
                    <div class="package-icon">‚ú®</div>
                    <div class="package-info">
                        <span class="package-name">Pro</span>
                        <span class="package-gems">150 gems</span>
                    </div>
                    <span class="package-price">129.000‚Ç´</span>
                </button>

                <button class="gem-package" data-package="premium">
                    <div class="package-icon">üëë</div>
                    <div class="package-info">
                        <span class="package-name">Premium</span>
                        <span class="package-gems">500 gems</span>
                    </div>
                    <span class="package-price">399.000‚Ç´</span>
                </button>
            </div>

            <p class="gems-panel-note">Thanh to√°n an to√†n qua Stripe tr√™n web app</p>
        </section>

        <!-- Language Selector Panel (hidden by default) -->
        <section id="language-panel" class="language-panel hidden">
            <div class="language-panel-header">
                <h3>üåê Ng√¥n ng·ªØ / Language</h3>
                <button id="close-language-panel" class="close-btn">√ó</button>
            </div>

            <div class="language-options">
                <button class="language-option" data-lang="vi">
                    <span class="lang-flag">üáªüá≥</span>
                    <span class="lang-name">Ti·∫øng Vi·ªát</span>
                </button>
                <button class="language-option" data-lang="en">
                    <span class="lang-flag">üá∫üá∏</span>
                    <span class="lang-name">English</span>
                </button>
                <button class="language-option" data-lang="ja">
                    <span class="lang-flag">üáØüáµ</span>
                    <span class="lang-name">Êó•Êú¨Ë™û</span>
                </button>
                <button class="language-option" data-lang="ko">
                    <span class="lang-flag">üá∞üá∑</span>
                    <span class="lang-name">ÌïúÍµ≠Ïñ¥</span>
                </button>
                <button class="language-option" data-lang="zh">
                    <span class="lang-flag">üá®üá≥</span>
                    <span class="lang-name">‰∏≠Êñá</span>
                </button>
                <button class="language-option" data-lang="th">
                    <span class="lang-flag">üáπüá≠</span>
                    <span class="lang-name">‡πÑ‡∏ó‡∏¢</span>
                </button>
                <button class="language-option" data-lang="id">
                    <span class="lang-flag">üáÆüá©</span>
                    <span class="lang-name">Bahasa Indonesia</span>
                </button>
                <button class="language-option" data-lang="es">
                    <span class="lang-flag">üá™üá∏</span>
                    <span class="lang-name">Espa√±ol</span>
                </button>
                <button class="language-option" data-lang="fr">
                    <span class="lang-flag">üá´üá∑</span>
                    <span class="lang-name">Fran√ßais</span>
                </button>
            </div>
        </section>

        <!-- Auth Section (shown when not logged in) -->
        <section id="auth-section" class="section auth-section hidden">
            <div>
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"
                    style="margin-bottom: 16px; opacity: 0.5;">
                    <circle cx="12" cy="8" r="4" />
                    <path d="M20 21a8 8 0 00-16 0" />
                </svg>
                <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ th·ª≠ ƒë·ªì v√† l∆∞u outfit</p>
                <div class="auth-buttons">
                    <button id="login-google-btn" class="btn btn-google btn-full">
                        <svg width="18" height="18" viewBox="0 0 24 24">
                            <path fill="#4285F4"
                                d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                            <path fill="#34A853"
                                d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                            <path fill="#FBBC05"
                                d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                            <path fill="#EA4335"
                                d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                        </svg>
                        Ti·∫øp t·ª•c v·ªõi Google
                    </button>

                    <!-- Divider -->
                    <div class="auth-divider">
                        <span>ho·∫∑c</span>
                    </div>

                    <!-- Skip Login Button -->
                    <button id="skip-login-btn" class="btn btn-skip btn-full">
                        D√πng th·ª≠ kh√¥ng ƒëƒÉng nh·∫≠p
                    </button>
                </div>
                <p class="auth-note">B·∫°n c√≥ th·ªÉ d√πng th·ª≠ v·ªõi t√≠nh nƒÉng h·∫°n ch·∫ø</p>
            </div>
        </section>

        <!-- Main Content (shown when logged in) -->
        <main id="main-content" class="main-body hidden">
            <!-- Demo Mode Banner -->
            <div id="demo-banner" class="demo-banner">
                üß™ Demo Mode - D·ªØ li·ªáu m·∫´u
            </div>

            <!-- Model Section -->
            <section class="section">
                <div class="section-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="8" r="4" />
                            <path d="M20 21a8 8 0 00-16 0" />
                        </svg>
                        ·∫¢nh c·ªßa b·∫°n
                    </h3>
                    <!-- Removed upload button as requested -->
                </div>
                <div id="model-image-container" class="image-container">
                    <div id="model-placeholder" class="placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <rect x="3" y="3" width="18" height="18" rx="2" />
                            <circle cx="8.5" cy="8.5" r="1.5" />
                            <path d="M21 15l-5-5L5 21" />
                        </svg>
                        <span>Ch·ªçn ·∫£nh b√™n d∆∞·ªõi ho·∫∑c t·∫£i l√™n</span>
                    </div>
                    <img id="model-image" class="preview-image hidden" alt="Model">
                </div>
                <input type="file" id="model-upload-input" accept="image/*" hidden>

                <!-- User's Model Images Gallery -->
                <div id="user-models-section" class="user-models-section">
                    <div class="user-models-list" id="user-models-list">
                        <!-- User models will be rendered here -->
                    </div>
                </div>
            </section>

            <!-- Product Section -->
            <section class="section">
                <div class="section-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path
                                d="M20.38 3.46L16 2a4 4 0 01-8 0L3.62 3.46a2 2 0 00-1.34 2.23l.58 3.47a1 1 0 00.99.84H6v10c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V10h2.15a1 1 0 00.99-.84l.58-3.47a2 2 0 00-1.34-2.23z" />
                        </svg>
                        Qu·∫ßn √°o
                    </h3>
                    <button id="paste-url-btn" class="section-action">D√°n URL</button>
                </div>
                <div id="clothing-image-container" class="image-container">
                    <div id="clothing-placeholder" class="placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <path
                                d="M20.38 3.46L16 2a4 4 0 01-8 0L3.62 3.46a2 2 0 00-1.34 2.23l.58 3.47a1 1 0 00.99.84H6v10c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V10h2.15a1 1 0 00.99-.84l.58-3.47a2 2 0 00-1.34-2.23z" />
                        </svg>
                        <span>Chu·ªôt ph·∫£i v√†o ·∫£nh tr√™n web ƒë·ªÉ th·ª≠</span>
                    </div>
                    <img id="clothing-image" class="preview-image hidden" alt="Clothing">
                </div>

            </section>

            <!-- Try On Button -->
            <section class="try-on-section">
                <button id="try-on-btn" class="try-on-btn" disabled>
                    ‚ú® Th·ª≠ ƒë·ªì ngay
                    <span class="gem-cost">(2 üíé)</span>
                </button>
            </section>

            <!-- Clothing History Section - Qu·∫ßn √°o ƒë√£ th·ª≠ -->
            <section id="clothing-history-section" class="section clothing-history-section">
                <div class="section-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path
                                d="M20.38 3.46L16 2a4 4 0 01-8 0L3.62 3.46a2 2 0 00-1.34 2.23l.58 3.47a1 1 0 00.99.84H6v10c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V10h2.15a1 1 0 00.99-.84l.58-3.47a2 2 0 00-1.34-2.23z" />
                        </svg>
                        ƒê√£ th·ª≠ g·∫ßn ƒë√¢y
                    </h3>
                    <div class="result-controls">
                        <button id="clear-clothing-history" class="clear-btn" title="X√≥a t·∫•t c·∫£">X√≥a h·∫øt</button>
                    </div>
                </div>
                <div class="clothing-history-grid" id="clothing-history-grid">
                    <!-- Clothing history will be rendered here -->
                </div>
            </section>

            <!-- Inline Result Section (Latest Result) -->
            <section id="inline-result-section" class="section inline-result-section hidden">
                <div class="section-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z" />
                            <path d="M2 17l10 5 10-5" />
                            <path d="M2 12l10 5 10-5" />
                        </svg>
                        K·∫øt qu·∫£ m·ªõi nh·∫•t
                    </h3>
                </div>

                <!-- Result Image Container -->
                <div class="inline-result-container">
                    <img id="inline-result-image" class="inline-result-image" src="" alt="Try-on result" />
                </div>

                <!-- Action Buttons -->
                <div class="inline-result-actions">
                    <button id="result-download-btn" class="result-action-btn" title="T·∫£i v·ªÅ">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" />
                        </svg>
                    </button>
                    <button id="result-copy-btn" class="result-action-btn" title="Copy ·∫£nh">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" />
                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" />
                        </svg>
                    </button>
                    <button id="result-save-btn" class="result-action-btn" title="L∆∞u v√†o t·ªß ƒë·ªì">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z" />
                        </svg>
                    </button>
                    <button id="result-share-btn" class="result-action-btn" title="Chia s·∫ª">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="18" cy="5" r="3" />
                            <circle cx="6" cy="12" r="3" />
                            <circle cx="18" cy="19" r="3" />
                            <path d="M8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98" />
                        </svg>
                    </button>
                    <button id="result-use-model-btn" class="result-action-btn" title="S·ª≠ d·ª•ng l√†m ·∫£nh m·∫´u">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" />
                            <circle cx="12" cy="7" r="4" />
                        </svg>
                    </button>
                    <button id="result-popup-btn" class="result-action-btn" title="M·ªü popup ri√™ng">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 3h6v6M14 10l7-7M10 3H3v18h18v-7" />
                        </svg>
                    </button>
                </div>

                <!-- Edit Section -->
                <div class="inline-edit-section">
                    <div class="edit-input-group">
                        <input type="text" id="inline-edit-input" class="edit-input"
                            placeholder="Nh·∫≠p y√™u c·∫ßu ch·ªânh s·ª≠a..." />
                        <button id="inline-edit-btn" class="edit-submit-btn" title="Ch·ªânh s·ª≠a">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" />
                                <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" />
                            </svg>
                        </button>
                    </div>
                    <div class="edit-suggestions">
                        <button class="edit-suggestion-btn" data-suggestion="ƒë·ªïi m√†u √°o sang ƒëen">M√†u ƒëen</button>
                        <button class="edit-suggestion-btn" data-suggestion="th√™m k√≠nh r√¢m">+K√≠nh</button>
                        <button class="edit-suggestion-btn" data-suggestion="th√™m m≈©">+M≈©</button>
                        <button class="edit-suggestion-btn" data-suggestion="x√≥a background">X√≥a n·ªÅn</button>
                    </div>
                </div>

                <!-- Report Wrong -->
                <div class="inline-result-footer">
                    <button id="report-wrong-btn" class="report-wrong-btn">
                        ·∫¢nh sai? Ho√†n gem üíé
                    </button>
                </div>
            </section>

            <!-- Result Thumbnails Section - History of all results -->
            <section id="result-preview-section" class="section hidden">
                <div class="section-header">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z" />
                            <path d="M2 17l10 5 10-5" />
                            <path d="M2 12l10 5 10-5" />
                        </svg>
                        K·∫øt qu·∫£
                    </h3>
                    <div class="result-controls">
                        <span id="result-count" class="result-count">0 k·∫øt qu·∫£</span>
                        <button id="clear-all-results" class="clear-btn" title="X√≥a t·∫•t c·∫£">X√≥a h·∫øt</button>
                    </div>
                </div>
                <div id="result-thumbnails" class="result-thumbnails">
                    <!-- Thumbnails of results will be rendered here -->
                </div>
            </section>



            <!-- Keyboard Shortcuts Hint -->
            <div class="shortcuts-hint">
                <span title="V: D√°n URL | T: Th·ª≠ ƒë·ªì | C: Copy | R: ƒê·ªïi t√™n | 1-9: M·ªü k·∫øt qu·∫£ | Esc: ƒê√≥ng">
                    ‚å®Ô∏è Ph√≠m t·∫Øt: <kbd>V</kbd> <kbd>T</kbd> <kbd>C</kbd> <kbd>R</kbd> <kbd>1-9</kbd>
                </span>
            </div>
        </main>

        <!-- Note: Result popups are now injected directly into the webpage for full-screen dragging -->

        <!-- Loading Overlay - Cute Animation -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="loading-animation">
                <!-- Animated Illustration -->
                <div class="loading-illustration">
                    <!-- Hanger SVG -->
                    <svg viewBox="0 0 100 100" class="loading-hanger">
                        <defs>
                            <linearGradient id="hangerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#f97316" />
                                <stop offset="100%" stop-color="#ec4899" />
                            </linearGradient>
                        </defs>
                        <!-- Hook -->
                        <path d="M50 10 Q50 4 55 4 Q60 4 60 10" fill="none" stroke="url(#hangerGrad)" stroke-width="3"
                            stroke-linecap="round" />
                        <!-- Hanger body -->
                        <path d="M50 18 L22 42 L78 42 Z" fill="none" stroke="url(#hangerGrad)" stroke-width="3"
                            stroke-linejoin="round" stroke-linecap="round" />
                    </svg>

                    <!-- Dress SVG (animated) -->
                    <svg viewBox="0 0 100 100" class="loading-dress">
                        <defs>
                            <linearGradient id="dressGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#f97316" />
                                <stop offset="50%" stop-color="#ec4899" />
                                <stop offset="100%" stop-color="#8b5cf6" />
                            </linearGradient>
                        </defs>
                        <!-- Dress body -->
                        <path d="M42 42 L36 88 Q50 96 64 88 L58 42 Q50 38 42 42" fill="url(#dressGrad)" opacity="0.9" />
                        <!-- Dress top -->
                        <path d="M44 38 Q50 32 56 38 L54 46 Q50 44 46 46 Z" fill="url(#dressGrad)" />
                        <!-- Sparkles -->
                        <circle cx="30" cy="55" r="2" fill="#fcd34d" class="sparkle" />
                        <circle cx="70" cy="60" r="1.5" fill="#fcd34d" class="sparkle-delay" />
                        <circle cx="50" cy="75" r="2" fill="#fcd34d" class="sparkle" />
                        <circle cx="28" cy="78" r="1" fill="#fcd34d" class="sparkle-delay" />
                        <circle cx="72" cy="82" r="1.5" fill="#fcd34d" class="sparkle" />
                    </svg>

                    <!-- Floating emojis -->
                    <span class="floating-emoji" style="font-size: 16px;">üíñ</span>
                    <span class="floating-emoji" style="font-size: 14px;">‚ú®</span>
                    <span class="floating-emoji" style="font-size: 15px;">üí´</span>
                    <span class="floating-emoji" style="font-size: 12px;">üåü</span>
                </div>

                <!-- Loading Text -->
                <p id="loading-text" class="loading-text">ƒêang t·∫°o ph√©p m√†u... ‚ú®</p>

                <!-- Progress Bar -->
                <div class="loading-progress">
                    <div id="loading-progress-bar" class="loading-progress-bar" style="width: 0%"></div>
                </div>
                <p id="loading-progress-text" class="loading-progress-text">...</p>

                <!-- Fun Tip -->
                <p id="loading-tip" class="loading-tip">üí° AI ƒëang ph√¢n t√≠ch h√†ng tri·ªáu pixels ƒë·ªÉ t·∫°o k·∫øt qu·∫£ ho√†n h·∫£o!
                </p>
            </div>
        </div>
    </div>

    <script src="../lib/icons.js"></script>
    <script src="../lib/i18n.js"></script>
    <script src="image_cache_db.js"></script>
    <script src="sidebar.js"></script>
</body>

</html>